# R 상관분석과 회귀분석

> 데이터에 따라 분석, 시각화 방법이 달라지기 때문에 데이터 타입을 파악하는것이 필요

## 1. 통계분석

#### 1) 전통적인 통계분석

- 모수를 추정하기 위해 샘플링하고 추정하는 작업
- 주로 **추론 분석**을 진행함

#### 2) 빅데이터 통계분석

- 이미 모수를 가지고 있음
- 데이터 안에 숨겨진 패턴, 규칙을 찾아서 원하는 분석 결과를 도출
- 데이터를 파악하려는 단계(EDA)에서 **기술통계** 분석 진행



### 기술통계

> 데이터의 특성을 이해하기 쉽게 기술하는 통계

- 수집한 데이터 정리, 그래프나 숫자 등으로 요약, 표현하는 등 데이터 특성 규명
- 평균, 중앙값, 최빈값, 범위, 분산, 표준편차, 사분위수, 도수분포표, 왜도, 첨도 등을 활용



## 2. 상관분석

> 두 변수간에 어떤 선형적 또는 비선형적 관계를 갖고 있는지를 분석하는 방법

- 두 변수는 서로 독립적인 관계이거나 상관된 관계일 수 있다.
- 이때 두 변수 간의 관계의 강도를 **상관계수**라고 한다.
- 상관관계의 정도를 파악하는 상관계수는 두 변수의 연관 정도만을 나타낸다.

### 피어슨 상관계수

- 두 연속성 변수간의 선형적인 관계를 측정하여 -1 과 1 사이의 값을 갖는다. 
- 1 또는 -1에 가까울수록 뚜렷한 선형적인 상관관계를 갖는다. 
  - 1애 가까울수록 우상향, -1에 가까울수록 우하향
- 산점도를 그려서 두 변수간의 상관관계를 시각적으로 파악할 수 있다.

```
X변수와 Y 변수의 상관계수 = X와 Y의 공분산 / X의 표준편차 * Y의 표준편차

               (X와 Y가 함께 변하는 정도를 X와 Y가 각각 변화는 정도로 나눈다.)
```

- R에서 지원하는 피어슨 상관계수를 계산하는 함수 : **cor(X, Y)**

```R
cor(백터 또는 매트릭스 또는 데이터 프레임(, 벡터 또는 매트릭스 또는 데이터프레임), method = c("pearson", "kendall", "spearman"))
```

- 여러 변수에 대해서 상관계수를 구하려는 경우에는 `corrplot()` 이나 `corrgram()` 등의 함수를 이용해서 시각화는 방법이 더욱 효과적이다.

### 스피어만 상관계수

- 두 변수에 대한 비선형 관계의 연관성을 파악할 수 있다 데이터가 서열 척도인 경우
- 값 대신 순위를 이용하는 경우에 사용된다
- 데이터의 개수가 적을 때 그리고 데이터의 동률이 많을 때 유용하다

### 켄달 상관계수

- 두 변수에 대한 비선형 관계의 연관성을 파악할 수 있다
- 데이터가 서열 척도인 경우 즉 값 대신 순위를 이용하는 경우에 사용된다
- 일반적으로 켄달 상관계수보다 높은 값을 갖는다



### 상관계수 검정

> `cor.test()` 함수를 사용하여 상관계수의 통계적 유의성 즉, 통계적으로 의미가 있는지 검증

- 귀무가설: 상관계수가 0 이다
  - 통상적으로 인정된는 일반적인 가설(대립가설의 반대)
- 대립가설: 상관계수는 0 이 아니다
  - 주장하려는 가설, 새로운 가설
- **기존가설(귀무가설)이 잘못됐다는 것을 증명함으로써 새로운 가설 대립가설을 채택**

#### p-value(유의확률)

- 귀무가설이 참이라는 가정하에 얻은 통계량이 귀무가설을 얼마나 지지하는지를 나타낸 확률
- **0.05 이하이면 귀무가설을 기각하고 이상이면 귀무가설을 채택**
- p-value 값이 적을수록 대립가설이 통계적의미를 갖는다고 할 수 있다.
-  p-value는 단지 주어진 분석에 대해서 귀무가설이 통계적으로 의미가 있는지 여부를 판단하는 기준일 뿐

![image](https://user-images.githubusercontent.com/73389275/111303496-f1cf2400-8697-11eb-8315-76d1da963fee.png)



## 3. 선형회귀분석

> 선형회귀는 종속변수 Y와 한개 이상의 독립변수(설명변수) X와의 관계를 모델링하는 회귀분석 기법이다.

![image](https://user-images.githubusercontent.com/73389275/111303567-03183080-8698-11eb-98c6-e62a88ed67f0.png)

![image](https://user-images.githubusercontent.com/73389275/111303579-06132100-8698-11eb-9a0a-b8912800f4ba.png)



- 한 개의 설명변수에 기반한 경우: **단순선형회귀**
- 두 이상의 설명변수에 기반한 경우: **다중선형회귀**
- 추세선을 이용하여 종속변수의 값을 예측하는 모델: 선형회귀 모델
- `lm()` 함수: 선형회귀 모델 생성
- `residuals()` 함수: 잔차 확인
- `predict.lm()` 함수: 종속변수 데이터 예측
- 결정계수: 추정한 선형 모델이 주어진 데이터에 적합한 정도 재는 척도
- `summary()`함수: 결정계수 수정된 결정계수 및 F 통계량 잔차 사분위수 회귀계수 확인
- `coef()`함수: 회귀계수만 출력

**종속변수(반응변수,관심변수)** : 영향을 받는 변수

**독립변수(설명변수)** : 영향을 주는 변수



### 단순선형회귀

> 하나의 독립변수와 하나의 종속변수 간의 회귀 분석을 **단순 회귀분석**이라고 하며 독립변수가 여러 개인 경우를 **다중 회귀분석**이라고 한다.

 독립변수(X) -----> 종속변수(Y)

 독립변수(X1) + 독립변수(X2)… -----> 종속변수(Y)

![image](https://user-images.githubusercontent.com/73389275/111305377-38be1900-869a-11eb-9b78-41eb9220b53b.png)

### 회귀분석

> 변수간의 관계를 추정하는 통계방법

#### 선형 회귀분석

독립변수에 대한 종속변수 값들을 이용해 두 변수간의 선형 관계를 설명하는 회귀선인 직선의 방정식(y = a + bx)를 만들고 임의의 x값에 대한 y값의 추정치를 추론하는 방법이다. 이 때 회귀선은 x에 대응하는 실제 y값과 추정된 y값 사이의 오차인 잔차를 최소화하는 직선을 잘 정해야 설명력이 좋은 회귀 방정식이 된다.

 

**회귀선(추세선)**을 찾는 방법은 범위탐색, 통계적 방법 그리고 머신러닝 방법이 사용되며 일반적으로 많이 사용되는 통계적 방법은 **잔차들의 제곱합이 최소화 하는 최소 제곱법**을 이용한다. 머신러닝 방법은 경사하강법이라는 방법을 이용한다. 



**lm(종속변수(결과) ~ 독립변수(원인),데이터)**

```R
# 회귀모델 만들기
model <- lm(circumference ~ age, Orange)

# 예측하기
predict.lm(model, newdata = data.frame(age = 100))

# 단순 회귀 모델 시각화
plot(Orange$age, Orange$circumference)
abline(coef(model))
```